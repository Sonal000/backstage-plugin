{"version":3,"file":"dtFetch.cjs.js","sources":["../../src/utils/dtFetch.ts"],"sourcesContent":["/**\r\n * @license\r\n * Copyright 2024 Dynatrace LLC\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nimport packageJson from '../../package.json';\r\nimport { getUserAgent } from './userAgent';\r\nimport { HttpsProxyAgent } from 'https-proxy-agent';\r\nimport fetch, { RequestInfo, RequestInit, Response } from 'node-fetch';\r\n\r\nconst userAgent: string = getUserAgent();\r\nconst agent = process.env.HTTPS_PROXY\r\n  ? new HttpsProxyAgent(process.env.HTTPS_PROXY)\r\n  : undefined;\r\n\r\nexport const dtFetch = (\r\n  url: RequestInfo,\r\n  identifier: string,\r\n  options: RequestInit = {},\r\n): Promise<Response> => {\r\n  // Set the User Agent in the headers\r\n  options.headers = {\r\n    ...options.headers,\r\n    'User-Agent': userAgent,\r\n    Referer: `backstage-plugin@${packageJson.version ?? '1.0.0'}/${identifier}`,\r\n  };\r\n\r\n  return fetch(url, { ...options, agent });\r\n};\r\n"],"names":["getUserAgent","HttpsProxyAgent","packageJson","fetch"],"mappings":";;;;;;;;;;;AAoBA,MAAM,YAAoBA,wBAAa,EAAA,CAAA;AACvC,MAAM,KAAA,GAAQ,QAAQ,GAAI,CAAA,WAAA,GACtB,IAAIC,+BAAgB,CAAA,OAAA,CAAQ,GAAI,CAAA,WAAW,CAC3C,GAAA,KAAA,CAAA,CAAA;AAEG,MAAM,UAAU,CACrB,GAAA,EACA,UACA,EAAA,OAAA,GAAuB,EACD,KAAA;AAEtB,EAAA,OAAA,CAAQ,OAAU,GAAA;AAAA,IAChB,GAAG,OAAQ,CAAA,OAAA;AAAA,IACX,YAAc,EAAA,SAAA;AAAA,IACd,SAAS,CAAoB,iBAAA,EAAAC,gBAAA,CAAY,OAAkB,IAAI,UAAU,CAAA,CAAA;AAAA,GAC3E,CAAA;AAEA,EAAA,OAAOC,uBAAM,GAAK,EAAA,EAAE,GAAG,OAAA,EAAS,OAAO,CAAA,CAAA;AACzC;;;;"}