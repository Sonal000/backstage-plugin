"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4533],{64533:(me,C,c)=>{c.r(C),c.d(C,{RealLogViewer:()=>ge});var v=c(77125),x=c(29365),O=c(99594),P=c(99870),L=c.n(P),a=c(14041),V=c(18690),U=c(19686),W=c(84392);function Z({onlyFirst:e=!1}={}){const n=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?(?:\\u0007|\\u001B\\u005C|\\u009C))","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(n,e?void 0:"g")}const E=Z(),B=/\n\r?/g,$=Object.fromEntries(Object.entries({1:e=>({...e,bold:!0}),3:e=>({...e,italic:!0}),4:e=>({...e,underline:!0}),22:({bold:e,...t})=>t,23:({italic:e,...t})=>t,24:({underline:e,...t})=>t,30:e=>({...e,foreground:"black"}),31:e=>({...e,foreground:"red"}),32:e=>({...e,foreground:"green"}),33:e=>({...e,foreground:"yellow"}),34:e=>({...e,foreground:"blue"}),35:e=>({...e,foreground:"magenta"}),36:e=>({...e,foreground:"cyan"}),37:e=>({...e,foreground:"white"}),39:({foreground:e,...t})=>t,90:e=>({...e,foreground:"grey"}),40:e=>({...e,background:"black"}),41:e=>({...e,background:"red"}),42:e=>({...e,background:"green"}),43:e=>({...e,background:"yellow"}),44:e=>({...e,background:"blue"}),45:e=>({...e,background:"magenta"}),46:e=>({...e,background:"cyan"}),47:e=>({...e,background:"white"}),49:({background:e,...t})=>t}).map(([e,t])=>[`\x1B[${e}m`,t]));class A{constructor(t=1,n=[]){this.lineNumber=t,this.chunks=n,this.text=n.map(o=>o.text).join("").toLocaleLowerCase("en-US")}text;lastChunk(){return this.chunks[this.chunks.length-1]}replaceLastChunk(t){t&&(this.chunks.splice(this.chunks.length-1,1,...t),this.text=this.chunks.map(n=>n.text).join("").toLocaleLowerCase("en-US"))}}class D{text="";lines=[];process(t){if(this.text===t)return this.lines;if(this.text&&t.startsWith(this.text)){const n=this.lines.length>0?this.lines.length-1:0,o=this.lines[n]??new A,s=o.lastChunk(),r=this.processLines((s?.text??"")+t.slice(this.text.length),s?.modifiers,o?.lineNumber);o.replaceLastChunk(r[0]?.chunks),this.lines[n]=o,this.lines=this.lines.concat(r.slice(1))}else this.lines=this.processLines(t);return this.text=t,this.lines}processLines=(t,n={},o=1)=>{const s=[];let r=n,l=o,h=0;for(B.lastIndex=0;;){const i=B.exec(t);if(!i){const p=this.processText(t.slice(h),r);return s.push(new A(l,p)),s}const d=t.slice(h,i.index);h=i.index+i[0].length;const u=this.processText(d,r);s.push(new A(l,u)),r=u[u.length-1].modifiers??r,l+=1}};processText=(t,n)=>{const o=[];let s=n,r=0;for(E.lastIndex=0;;){const l=E.exec(t);if(!l)return o.push({text:t.slice(r),modifiers:s}),o;const h=t.slice(r,l.index);o.push({text:h,modifiers:s}),r=l.index+l[0].length,s=this.processCode(l[0],s)}};processCode=(t,n)=>$[t]?.(n)??n}var G=c(95479),R=c.n(G),Y=c(37639),w=c(75202);function X(e,t){const n=new Array;if(t.bold&&n.push(e.modifierBold),t.italic&&n.push(e.modifierItalic),t.underline&&n.push(e.modifierUnderline),t.foreground){const o=`modifierForeground${R()(t.foreground)}`;n.push(e[o])}if(t.background){const o=`modifierBackground${R()(t.background)}`;n.push(e[o])}return n.length>0?n.join(" "):void 0}function J(e,t){if(!t||!e.includes(t))return;const n=new Array;let o=0;for(;;){const s=e.indexOf(t,o);if(s===-1)break;const r=s+t.length;n.push({start:s,end:r}),o=r}return n}function Q(e,t){const n=J(e.text,t);if(!n)return e.chunks;const o=new Array;let s=0,r=0,l=n[r];for(const h of e.chunks){const{text:i,modifiers:d}=h;if(!l||s+i.length<l.start){o.push(h),s+=i.length;continue}let u=0;for(;l;){const g=Math.max(l.start-s,0);if(g>i.length)break;const f=Math.min(l.end-s,i.length);if(g>u&&o.push({text:i.slice(u,g),modifiers:d}),f>g&&o.push({modifiers:d,highlight:r,text:i.slice(g,f)}),u=f,l.end-s===f)r+=1,l=n[r];else break}u<i.length&&o.push({text:i.slice(u),modifiers:d}),s+=i.length}return o}const q=({attributes:e,content:t})=>{const{href:n,...o}=e;return a.createElement(w.N_,{to:n,...o},t)};function _({line:e,classes:t,searchText:n,highlightResultIndex:o}){const s=(0,a.useMemo)(()=>Q(e,n),[e,n]),r=(0,a.useMemo)(()=>s.map(({text:l,modifiers:h,highlight:i},d)=>a.createElement("span",{key:d,className:L()(X(t,h),i!==void 0&&(i===o?t.textSelectedHighlight:t.textHighlight))},a.createElement(Y.A,{options:{render:q}},l))),[s,o,t]);return a.createElement(a.Fragment,null,r)}var ee=c(16249),te=c(72501),ne=c(68887),oe=c(63798),I=c(65859);function se(e){const{resultCount:t,resultIndexStep:n,toggleShouldFilter:o}=e,s=e.resultIndex??0,r=l=>{l.key==="Enter"&&(l.metaKey||l.ctrlKey||l.altKey?o():n(l.shiftKey))};return a.createElement(a.Fragment,null,t!==void 0&&a.createElement(a.Fragment,null,a.createElement(x.A,{size:"small",onClick:()=>n(!0)},a.createElement(ne.A,null)),a.createElement(te.A,null,Math.min(s+1,t),"/",t),a.createElement(x.A,{size:"small",onClick:()=>n()},a.createElement(oe.A,null))),a.createElement(ee.A,{size:"small",variant:"standard",placeholder:"Search",value:e.searchInput,onKeyPress:r,onChange:l=>e.setSearchInput(l.target.value)}),a.createElement(x.A,{size:"small",onClick:o},e.shouldFilter?a.createElement(I.A,{color:"primary"}):a.createElement(I.A,{color:"disabled"})))}var re=c(58837),b=c(268),y=c(95186),F=c(38084),M=c(54024),N=c(40935),T=c(4499),z=c(85229),j=c(42020),K=c(6456);const H=40,le=(0,re.A)(e=>({root:{background:e.palette.background.paper},header:{height:H,display:"flex",alignItems:"center",justifyContent:"flex-end"},log:{fontFamily:'"Monaco", monospace',fontSize:e.typography.pxToRem(12)},line:{position:"relative",whiteSpace:"pre","&:hover":{background:e.palette.action.hover}},lineSelected:{background:e.palette.action.selected,"&:hover":{background:e.palette.action.selected}},lineCopyButton:{position:"absolute",paddingTop:0,paddingBottom:0},lineNumber:{display:"inline-block",textAlign:"end",width:60,marginRight:e.spacing(1),cursor:"pointer"},textHighlight:{background:(0,b.X4)(e.palette.info.main,.15)},textSelectedHighlight:{background:(0,b.X4)(e.palette.info.main,.4)},modifierBold:{fontWeight:e.typography.fontWeightBold},modifierItalic:{fontStyle:"italic"},modifierUnderline:{textDecoration:"underline"},modifierForegroundBlack:{color:y.A.black},modifierForegroundRed:{color:F.A[500]},modifierForegroundGreen:{color:M.A[500]},modifierForegroundYellow:{color:N.A[500]},modifierForegroundBlue:{color:T.A[500]},modifierForegroundMagenta:{color:z.A[500]},modifierForegroundCyan:{color:j.A[500]},modifierForegroundWhite:{color:y.A.white},modifierForegroundGrey:{color:K.A[500]},modifierBackgroundBlack:{background:y.A.black},modifierBackgroundRed:{background:F.A[500]},modifierBackgroundGreen:{background:M.A[500]},modifierBackgroundYellow:{background:N.A[500]},modifierBackgroundBlue:{background:T.A[500]},modifierBackgroundMagenta:{background:z.A[500]},modifierBackgroundCyan:{background:j.A[500]},modifierBackgroundWhite:{background:y.A.white},modifierBackgroundGrey:{background:K.A[500]}}),{name:"BackstageLogViewer"});var ie=c(73518);function ae(e,t){if(!t)return{lines:e};const n=[],o=[];for(const s of e)if(s.text.includes(t)){n.push(s);let r=0,l=0;for(;;){const h=s.text.indexOf(t,r);if(h===-1)break;o.push({lineNumber:s.lineNumber,lineIndex:l++}),r=h+t.length}}return{lines:n,results:o}}function ce(e){const[t,n]=(0,a.useState)(""),o=t.toLocaleLowerCase("en-US"),[s,r]=(0,a.useState)(0),[l,h]=(0,ie.e)(!1),i=(0,a.useMemo)(()=>ae(e,o),[e,o]),d=i.results?i.results[Math.min(s,i.results.length-1)]:void 0,u=i.results?.length,p=g=>{if(g){if(u!==void 0){const f=Math.min(s-1,u-2);r(f<0?u-1:f)}}else if(u!==void 0){const f=s+1;r(f>=u?0:f)}};return{lines:l?i.lines:e,searchText:o,searchInput:t,setSearchInput:n,shouldFilter:l,toggleShouldFilter:h,resultCount:u,resultIndex:s,resultIndexStep:p,resultLine:d?.lineNumber,resultLineIndex:d?.lineIndex}}var ue=c(18139),de=c(24453),he=c(36338);function fe(e){const t=(0,ue.gf)(de.m),[n,o]=(0,a.useState)(),s=n?Math.min(n.start,n.end):void 0,r=n?Math.max(n.start,n.end):void 0,[{error:l},h]=(0,he.A)();return(0,a.useEffect)(()=>{l&&t.post(l)},[l,t]),{shouldShowButton(i){return s===i||r===i},isSelected(i){return n?s<=i&&i<=r:!1},setSelection(i,d){o(d?u=>u?{start:u.start,end:i}:{start:i,end:i}:u=>u?.start===i&&u?.end===i?void 0:{start:i,end:i})},copySelection(){if(n){const i=e.slice(Math.min(n.start,n.end)-1,Math.max(n.start,n.end)).map(d=>d.chunks.map(u=>u.text).join("")).join(`
`);h(i),o(void 0)}}}}function ge(e){const t=le({classes:e.classes}),n=(0,a.useRef)(null),s=(0,a.useMemo)(()=>new D,[]).process(e.text),r=ce(s),l=fe(s),h=(0,V.zy)();(0,a.useEffect)(()=>{r.resultLine!==void 0&&n.current&&n.current.scrollToItem(r.resultLine-1,"center")},[r.resultLine]),(0,a.useEffect)(()=>{if(h.hash){const d=parseInt(h.hash.replace(/\D/g,""),10);l.setSelection(d,!1)}},[]);const i=(d,u)=>{l.setSelection(d,u.shiftKey)};return a.createElement(U.Ay,null,({height:d,width:u})=>a.createElement(v.A,{style:{width:u,height:d},className:t.root},a.createElement(v.A,{className:t.header},a.createElement(se,{...r})),a.createElement(W.Y1,{ref:n,className:t.log,height:(d||480)-H,width:u||640,itemData:r.lines,itemSize:20,itemCount:r.lines.length},({index:p,style:g,data:f})=>{const S=f[p],{lineNumber:m}=S;return a.createElement(v.A,{style:{...g},className:L()(t.line,{[t.lineSelected]:l.isSelected(m)})},l.shouldShowButton(m)&&a.createElement(x.A,{"data-testid":"copy-button",size:"small",className:t.lineCopyButton,onClick:()=>l.copySelection()},a.createElement(O.A,{fontSize:"inherit"})),a.createElement("a",{role:"row",target:"_self",href:`#line-${m}`,className:t.lineNumber,onClick:k=>i(m,k),onKeyPress:k=>i(m,k)},m),a.createElement(_,{line:S,classes:t,searchText:r.searchText,highlightResultIndex:r.resultLine===m?r.resultLineIndex:void 0}))})))}}}]);})();

//# sourceMappingURL=4533.7ca5499e.chunk.js.map